<html><head><link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="./my-youtube-video.html">
<link rel="import" href="./my-searchbar.html">
<link rel="import" href="shared-styles.html">
<link rel="import" href="../bower_components/paper-spinner/paper-spinner.html">
<link rel="import" href="./my-noresult-view.html">

</head><body><dom-module id="my-favorites">
    <template>
        <style include="shared-styles">
             :host {
                display: block;
            }

            .card {
                margin: 34px;
            }

            paper-search-bar {
                --input-font-size: 20px;
            }
        </style>
        <paper-spinner active$="[[loading]]"></paper-spinner>

        <my-noresult-view text="No favorites found" active$="[[empty]]"></my-noresult-view>

        <iron-ajax id="ajax" url="" handle-as="json" on-response="hresponse"></iron-ajax>
        <template is="dom-repeat" id="videosList" items="{{videoFavItems}}" as="video">
            <my-youtube-video stored-favs="{{storedFavs}}" liked="" video-id="{{video.id.videoId}}" video-description="{{video.snippet.description}}" video-title="{{video.snippet.title}}"></my-youtube-video>
        </template>

    </template>
    <script>Polymer({is:"my-favorites",properties:{empty:{type:String,value:!1},storedFavs:{type:Array,notify:!0,value:function(){return[]}},loading:{type:Boolean,value:!0}},observers:["favsChanged(storedFavs.splices)"],ready:function(){if(this.videoFavItems=[],!this.storedFavs||!this.storedFavs.length)return this.empty=!0,void(this.loading=!1);console.log(this.storedFavs);for(var e=0;e<this.storedFavs.length;e++)this.$.ajax.url="https://www.googleapis.com/youtube/v3/search",this.$.ajax.params={part:"snippet",q:this.storedFavs[e],key:"AIzaSyAuecFZ9xJXbGDkQYWBmYrtzOGJD-iDIgI",type:"video"},this.$.ajax.generateRequest()},hresponse:function(e){this.push("videoFavItems",e.detail.response.items[0]),console.log(this.videoFavItems[this.videoFavItems.length-1].id.videoId),this.loading=!1},favsChanged:function(e){console.log("faves changed "+e)}});</script>
</dom-module>
</body></html>